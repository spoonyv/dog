<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Party Dog Generator</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background-color: #f0f0f0; }
        #image-container { margin: 20px auto; width: 512px; height: 512px; border: 2px solid #ccc; background-color: #fff; }
        #generate-btn { padding: 10px 20px; font-size: 16px; cursor: pointer; background-color: #4CAF50; color: white; border: none; border-radius: 5px; }
        #generate-btn:hover { background-color: #45a049; }
        #loading { display: none; font-style: italic; color: #666; }
    </style>
</head>
<body>
    <h1>Funny Party Dog Generator</h1>
    <p>Click the button to generate a new funny 512x512 party dog in cool clothes with a beverage!</p>
    <button id="generate-btn">Generate New Dog</button>
    <div id="loading">Generating... Please wait.</div>
    <div id="image-container">
        <img id="party-dog" src="" alt="Party Dog" style="width: 100%; height: 100%; display: none;">
    </div>

    <script>
        const generateBtn = document.getElementById('generate-btn');
        const loading = document.getElementById('loading');
        const partyDogImg = document.getElementById('party-dog');

        async function generateImage() {
            generateBtn.disabled = true;
            loading.style.display = 'block';
            partyDogImg.style.display = 'none';

            try {
                // Generate a random seed between 0 and 2^32 - 1
                const seed = Math.floor(Math.random() * 4294967296);

                // Call the Netlify Function proxy
                const response = await fetch('/.netlify/functions/generate-image', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ seed })
                });

                if (!response.ok) {
                    throw new Error('Failed to generate image');
                }

                const data = await response.json();
                partyDogImg.src = data.imageUrl; // Assuming the API returns an image URL
                partyDogImg.style.display = 'block';
            } catch (error) {
                console.error('Error:', error);
                alert('Oops! Something went wrong. Try again.');
            } finally {
                generateBtn.disabled = false;
                loading.style.display = 'none';
            }
        }

        generateBtn.addEventListener('click', generateImage);
        // Generate once on load
        generateImage();
    </script>
</body>
</html>